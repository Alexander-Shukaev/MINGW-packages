# Maintainer: Haroogan <Haroogan@gmail.com>

_realname='conemu'
pkgname="${MINGW_PACKAGE_PREFIX}-${_realname}"
pkgver=150420
pkgrel=1
pkgdesc="Customizable Windows console emulator with tabs (mingw-w64)"
url="http://code.google.com/p/${_realname}-maximus5/"
license=('BSD New')
arch=('any')
# CAUTION:
# Don't remove `!strip' option!  Otherwise, 64-bit version of ConEmu will signal
# errors at startup.
options=('!strip')
source=("http://downloads.sourceforge.net/project/${_realname}/Preview/ConEmuPack.${pkgver}.7z"
        'ConEmu.xml')
sha256sums=('f6ab9e22dfa32cbed1ac84cd5b300e61f2fd305567cbc9813c36ccd33fb66bd2'
            '84c201cf676aae844a5c00b20ce8912f004562422a3e340fe01c786ab666062c')

package_mingw-w64-i686-conemu() {
  optdepends=('mingw-w64-x86_64-conemu')

  mkdir -p "${pkgdir}${MINGW_PREFIX}/bin/ConEmu"

  cp "ConEmu.xml" "${pkgdir}${MINGW_PREFIX}/bin/ConEmu"
  cp "ConEmu.exe" "${pkgdir}${MINGW_PREFIX}/bin"

  cd "ConEmu"

  cp "ConEmuC.exe"  "${pkgdir}${MINGW_PREFIX}/bin/ConEmu"
  cp "ConEmuCD.dll" "${pkgdir}${MINGW_PREFIX}/bin/ConEmu"
  cp "ConEmuHk.dll" "${pkgdir}${MINGW_PREFIX}/bin/ConEmu"

  mkdir -p "${pkgdir}${MINGW_PREFIX}/../mingw64/bin/ConEmu"

  cp "ConEmuC.exe"  "${pkgdir}${MINGW_PREFIX}/../mingw64/bin/ConEmu"
  cp "ConEmuCD.dll" "${pkgdir}${MINGW_PREFIX}/../mingw64/bin/ConEmu"
  cp "ConEmuHk.dll" "${pkgdir}${MINGW_PREFIX}/../mingw64/bin/ConEmu"
}

package_mingw-w64-x86_64-conemu() {
  optdepends=('mingw-w64-i686-conemu')

  mkdir -p "${pkgdir}${MINGW_PREFIX}/bin/ConEmu"

  cp "ConEmu.xml"   "${pkgdir}${MINGW_PREFIX}/bin/ConEmu"
  cp "ConEmu64.exe" "${pkgdir}${MINGW_PREFIX}/bin"

  cd "ConEmu"

  cp "ConEmuC64.exe"  "${pkgdir}${MINGW_PREFIX}/bin/ConEmu"
  cp "ConEmuCD64.dll" "${pkgdir}${MINGW_PREFIX}/bin/ConEmu"
  cp "ConEmuHk64.dll" "${pkgdir}${MINGW_PREFIX}/bin/ConEmu"

  mkdir -p "${pkgdir}${MINGW_PREFIX}/../mingw32/bin/ConEmu"

  cp "ConEmuC64.exe"  "${pkgdir}${MINGW_PREFIX}/../mingw32/bin/ConEmu"
  cp "ConEmuCD64.dll" "${pkgdir}${MINGW_PREFIX}/../mingw32/bin/ConEmu"
  cp "ConEmuHk64.dll" "${pkgdir}${MINGW_PREFIX}/../mingw32/bin/ConEmu"
}
